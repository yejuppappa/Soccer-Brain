# âš½ Soccer Brain - ë°°ë‹¹ íë¦„ ì¶”ì  (10ë¶„ ê°„ê²©)
# í•µì‹¬: ë¶ë©”ì´ì»¤ ë°°ë‹¹ ìŠ¤ëƒ…ìƒ·ì„ 10ë¶„ë§ˆë‹¤ ìˆ˜ì§‘í•˜ì—¬ ë°°ë‹¹ íë¦„ ë¶„ì„

name: ğŸ’° 10min Odds Tracking

on:
  schedule:
    - cron: "*/10 * * * *"
  
  workflow_dispatch:

# ë™ì‹œ ì‹¤í–‰ ë°©ì§€: ì´ì „ ì‹¤í–‰ì´ ì•ˆ ëë‚¬ìœ¼ë©´ ëŒ€ê¸°
concurrency:
  group: odds-tracking
  cancel-in-progress: false

jobs:
  odds:
    runs-on: ubuntu-latest
    timeout-minutes: 8

    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Node.js ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm install --ignore-scripts
        env:
          PUPPETEER_SKIP_DOWNLOAD: "true"

      - name: ğŸ”§ Prisma ìƒì„±
        run: npx prisma generate

      - name: ğŸ’° ë°°ë‹¹ ìˆ˜ì§‘
        run: npx tsx scripts/collect.ts odds
        env:
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
          API_SPORTS_KEY: ${{ secrets.API_SPORTS_KEY }}
